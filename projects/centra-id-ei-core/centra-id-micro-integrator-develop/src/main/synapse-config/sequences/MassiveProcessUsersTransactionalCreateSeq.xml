<?xml version="1.0" encoding="UTF-8"?>
<sequence name="MassiveProcessUsersTransactionalCreateSeq" onError="FaultMassiveProcessUsersSeq" trace="disable" xmlns="http://ws.apache.org/ns/synapse" xmlns:cen="centra-id.com">
    <log level="custom" category="DEBUG">
        <property name="MassiveProcessUsersTransactionalCreateSeq" value="Inicio..." />
        <property name="currentDate" expression="get-property('currentDate')" />
    </log>
    <payloadFactory media-type="json">
        <format>
            {
                "transactionalIdentity": {
                    "uuid": "$1",
                    "guid": "$2",
                    "username": "$3",
                    "workerCode": "$4",
                    "employeeLastName": "$5",
                    "employeeFirstName": "$6",
                    "Identification": "$7",
                    "identificationSupervisor": "$8",
                    "namesSupervisor": "$9",
                    "companyCode": "$10",
                    "companyName": "$11",
                    "groupCode": "$12",
                    "groupName": "$13",
                    "divisionCode": "$14",
                    "divisionName": "$15",
                    "departmentCode": "$16",
                    "departmentName": "$17",
                    "areaCode": "$18",
                    "areaName": "$19",
                    "subsidiaryCode": "$20",
                    "subsidiaryName": "$21",
                    "costCenterCode": "$22",
                    "costCenterName": "$23",
                    "locationCode": "$24",
                    "localtionName": "",                    
                    "positionName": "$25",
                    "hierarchicalLevelCode": "$26",
                    "hierarchicalLevelName": "$27",
                    "depositAccountNumber": "$28",
                    "employeeStartDate": "$29",
                    "employeeEndDate": "$30",
                    "employeeStatus": "ACTIVO",
                    "employeeCode": "$32",
                    "userType": "$33",
                    "userSubType": "$34",
                    "mobile": "$35",
                    "origen": "CARGAMASIVA",
                    "status": "REGISTRADO",
                    "createdDate": "$36",
                    "plannedExecutionDate": "$37",
                    "modifyData": $38,
                    "profileRecalculation":$39,
                    "typeAction":"$40"
                }
            }            
        </format>
        <args>
            <arg evaluator="xml" expression="//*:guid" />
            <arg evaluator="xml" expression="//*:uuid" />
            <arg evaluator="xml" expression="//*:username" />
            <arg evaluator="xml" expression="//*:codigoTrabajador" />
            <arg evaluator="xml" expression="//*:apellidosEmpleado" />
            <arg evaluator="xml" expression="//*:nombresEmpleado" />
            <arg evaluator="xml" expression="//*:identificacion" />
            <arg evaluator="xml" expression="//*:identificacionSupervisor" />
            <arg evaluator="xml" expression="//*:nombreSupervisor" />
            <arg evaluator="xml" expression="//*:codigoCompania" />
            <arg evaluator="xml" expression="//*:nombreCompania" />
            <arg evaluator="xml" expression="//*:codigoAgrupacion" />
            <arg evaluator="xml" expression="//*:nombreAgrupacion" />
            <arg evaluator="xml" expression="//*:codigoDivision" />
            <arg evaluator="xml" expression="//*:nombreDivision" />
            <arg evaluator="xml" expression="//*:codigoDepartamento" />
            <arg evaluator="xml" expression="//*:nombreDepartamento" />
            <arg evaluator="xml" expression="//*:codigoArea" />
            <arg evaluator="xml" expression="//*:nombreArea" />
            <arg evaluator="xml" expression="//*:codigoSucursal" />
            <arg evaluator="xml" expression="//*:nombreSucursal" />
            <arg evaluator="xml" expression="//*:codigoCentroCosto" />
            <arg evaluator="xml" expression="//*:nombreCentroCosto" />
            <arg evaluator="xml" expression="//*:nombreLocalidad" />
            <arg evaluator="xml" expression="//*:nombreCargo" />
            <arg evaluator="xml" expression="//*:codigoNivelJerarquico" />
            <arg evaluator="xml" expression="//*:nombreNivelJerarquico" />
            <arg evaluator="xml" expression="//*:numeroCuentaDeposito" />
            <arg evaluator="xml" expression="//*:fechaIngresoEmpleado" />
            <arg evaluator="xml" expression="//*:fechaSalidaEmpleado" />
            <arg evaluator="xml" expression="//*:estadoEmpleado" />
            <arg evaluator="xml" expression="//*:codigoEmpleado" />
            <arg evaluator="xml" expression="//*:tipoUsuario" />
            <arg evaluator="xml" expression="//*:subTipo" />
            <arg evaluator="xml" expression="//*:celular" />
            <arg evaluator="xml" expression="get-property('currentDate')" />
            <arg evaluator="xml" expression="get-property('currentDate')" />
            <arg evaluator="xml" expression="//*:modificaDatos" />
            <arg evaluator="xml" expression="//*:recalculoPerfil" />
            <arg evaluator="xml" expression="//*:typeEvent" />
        </args>
    </payloadFactory>
    <call>
        <endpoint template="HTTPEndpointPostTemplate" uri="{uri.var.enterpriseIntegratorHost}/api.centraid/provisioning/TransactionalIdentity" />
    </call>
    <filter regex="200" source="get-property('axis2', 'HTTP_SC')">
        <then></then>
        <else>
            <sequence key="FaultMassiveProcessUsersSeq" />
        </else>
    </filter>
    <log level="custom" category="DEBUG">
        <property name="MassiveProcessUsersTransactionalCreateSeq" value="Fin..." />
    </log>
</sequence>
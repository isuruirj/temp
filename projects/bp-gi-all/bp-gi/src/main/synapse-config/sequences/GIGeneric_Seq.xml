<?xml version="1.0" encoding="UTF-8"?>
<sequence name="GIGeneric_Seq" onError="GIGeneric_Fault_Seq" trace="disable" xmlns="http://ws.apache.org/ns/synapse">
    <property description="aplicacion" expression="lower-case($body//*/tem:aplicacion)" name="aplicacion" scope="default" type="STRING" xmlns:tem="http://tempuri.org/"/>
    <log description="Log Properties" level="custom">
        <property name="seq" value="-------------------- GIGeneric_Seq --------------------"/>
        <property expression="get-property('aplicacion')" name="aplicacion"/>
        <property expression="$body//*/tem:tellerName/text()" name="username" xmlns:tem="http://tempuri.org/"/>
        <property expression="get-property('Action')" name="SOAP_ACTION_REQUEST"/>
    </log>
    <switch source="get-property('Action')">
        <case regex=".*consultarUsuario.*">
            <sequence key="GIProperties_Seq"/>
            <sequence key="GISCIM_ConsultarUsuario_Seq"/>
        </case>
        <case regex=".*crearTicket.*">
            <log description="msg" level="custom">
                <property name="msg" value="---------- Manual HP Ticket creation ----------"/>
            </log>
            <sequence key="GIProperties_Seq"/>
            <property description="scimResponse" expression="$body/*/tem:ERROR/text()" name="scimResponse" scope="default" type="STRING" xmlns:tem="http://tempuri.org/"/>
            <sequence key="GIHelpDesk_TicketPayload_Seq"/>
            <log description="Log Request" level="full"/>
            <sequence key="GIHelpDesk_CreateTicket_Seq"/>
        </case>
        <default>
            <store description="GIGeneric_Store" messageStore="GIGeneric_Store"/>
            <switch description="SOAP_ACTION_REQUEST" source="get-property('Action')">
                <case regex=".*crearUsuario.*">
                    <payloadFactory description="crearUsuario" media-type="xml">
                        <format>
                            <ns1:crearUsuarioResponse xmlns:ns1="http://tempuri.org/">
                                <ns1:tellerNo>0</ns1:tellerNo>
                                <ns1:crearUsuarioResult>
                                    <ns1:aplicacion>$1</ns1:aplicacion>
                                    <ns1:codigoError>0</ns1:codigoError>
                                    <ns1:descripcionError>OK</ns1:descripcionError>
                                </ns1:crearUsuarioResult>
                            </ns1:crearUsuarioResponse>
                        </format>
                        <args>
                            <arg evaluator="xml" expression="get-property('aplicacion')"/>
                        </args>
                    </payloadFactory>
                </case>
                <case regex=".*modificarUsuario.*">
                    <payloadFactory description="modificarUsuario" media-type="xml">
                        <format>
                            <ns1:modificarUsuarioResponse xmlns:ns1="http://tempuri.org/">
                                <ns1:tellerNo>0</ns1:tellerNo>
                                <ns1:modificarUsuarioResult>
                                    <ns1:aplicacion>$1</ns1:aplicacion>
                                    <ns1:codigoError>0</ns1:codigoError>
                                    <ns1:descripcionError>OK</ns1:descripcionError>
                                </ns1:modificarUsuarioResult>
                            </ns1:modificarUsuarioResponse>
                        </format>
                        <args>
                            <arg evaluator="xml" expression="get-property('aplicacion')"/>
                        </args>
                    </payloadFactory>
                </case>
                <case regex=".*eliminarUsuario.*">
                    <payloadFactory description="eliminarUsuario" media-type="xml">
                        <format>
                            <ns1:eliminarUsuarioResponse xmlns:ns1="http://tempuri.org/">
                                <ns1:aplicacion>$1</ns1:aplicacion>
                                <ns1:codigoError>0</ns1:codigoError>
                                <ns1:descripcionError>OK</ns1:descripcionError>
                            </ns1:eliminarUsuarioResponse>
                        </format>
                        <args>
                            <arg evaluator="xml" expression="get-property('aplicacion')"/>
                        </args>
                    </payloadFactory>
                </case>
                <case regex=".*crearRequerimientos.*">
                    <payloadFactory description="crearRequerimientos" media-type="xml">
                        <format>
                            <ns1:crearRequerimientosResponse xmlns:ns1="http://tempuri.org/">
                                <ns1:crearRequerimientosResult>
                                    <ns1:codigoError>0</ns1:codigoError>
                                    <ns1:descripcionError>OK</ns1:descripcionError>
                                </ns1:crearRequerimientosResult>
                            </ns1:crearRequerimientosResponse>
                        </format>
                        <args/>
                    </payloadFactory>
                </case>
                <default/>
            </switch>
        </default>
    </switch>
</sequence>

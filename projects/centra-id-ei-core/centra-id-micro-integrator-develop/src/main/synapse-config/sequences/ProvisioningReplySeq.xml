<?xml version="1.0" encoding="UTF-8"?>
<sequence name="ProvisioningReplySeq" onError="FaultSeq" trace="disable" xmlns="http://ws.apache.org/ns/synapse">
    <log level="custom" category="DEBUG">
        <property name="ProvisioningReplySeq" value="Inicio.." />
        <property name="uri.var.taskProvisioningId" expression="$ctx:uri.var.taskProvisioningId" />
    </log>
    <!--
    <call>
        <endpoint template="HTTPEndpointGetTemplate" uri="{uri.var.enterpriseIntegratorHost}/api.centraid/provisioning/TaskProvisioningSimple/{uri.var.taskProvisioningId}" />
    </call>
    <filter regex="200" source="get-property('axis2', 'HTTP_SC')">
        <then>
            <property name="taskProvisioning" expression="$body//*" scope="default" type="OM" />
        </then>
        <else>
            <property name="fault" value="ProvisioningReplySeq: Error get TaskProvisioning" />
            <sequence key="FaultUserDataSeq" />
        </else>
    </filter>
    <payloadFactory media-type="json">
        <format>
            {
                "taskProvisioning": {
                    "id" :$1,
                    "transactionalProfileId": $2,
                    "applicationId" : $3,
                    "operationProvisioningId" : $4,
                    "provisioningDate" : "$5",
                    "provisioningStatus" : "$6",
                    "provisioningComments": "$7",
                    "creationDate": "$8",
                    "uuid":"$9",
                    "uuidParent": "$10",
                    "ticketNumber": "$11",
                    "ticketDate": "$12",
                    "ticketContent": "$13",
                    "ticketError": "$14",        
                    "action": "$15",
                    "type" : "$16",
                    "status": "ENCOLA"
                
                }
            }            
        </format>
        <args>
            <arg evaluator="xml" expression="$ctx:taskProvisioning//id" />
            <arg evaluator="xml" expression="$ctx:taskProvisioning//transactionalProfileId" />
            <arg evaluator="xml" expression="$ctx:taskProvisioning//applicationId" />
            <arg evaluator="xml" expression="$ctx:taskProvisioning//operationProvisioningId" />
            <arg evaluator="xml" expression="$ctx:taskProvisioning//provisioningDate" />
            <arg evaluator="xml" expression="$ctx:taskProvisioning//provisioningStatus" />
            <arg evaluator="xml" expression="$ctx:taskProvisioning//provisioningComments" />
            <arg evaluator="xml" expression="$ctx:taskProvisioning//creationDate" />
            <arg evaluator="xml" expression="$ctx:taskProvisioning//uuid" />
            <arg evaluator="xml" expression="$ctx:taskProvisioning//uuidParent" />
            <arg evaluator="xml" expression="$ctx:taskProvisioning//ticketNumber" />
            <arg evaluator="xml" expression="$ctx:taskProvisioning//ticketDate" />
            <arg evaluator="xml" expression="$ctx:taskProvisioning//ticketContent" />
            <arg evaluator="xml" expression="$ctx:taskProvisioning//ticketError" />
            <arg evaluator="xml" expression="$ctx:taskProvisioning//action" />
            <arg evaluator="xml" expression="$ctx:taskProvisioning//type" />
        </args>
    </payloadFactory>
    <call>
        <endpoint template="HTTPEndpointPutTemplate" uri="{uri.var.enterpriseIntegratorHost}/api.centraid/provisioning/TaskProvisioningSimple" />
    </call>
    <filter regex="202" source="get-property('axis2', 'HTTP_SC')">
        <then></then>
        <else>
            <property name="fault" value="ProvisioningReplySeq: error when update TaskProvisioning" />
            <sequence key="FaultSeq" />
        </else>
    </filter>
    -->
    <log level="custom" category="DEBUG">
        <property name="ProvisioningReplySeq" value="Fin.." />
    </log>
</sequence>
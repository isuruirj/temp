<?xml version="1.0" encoding="UTF-8"?>
<sequence name="CrearRegistroCargaMasivaSeq" onError="FaultProcesarEmpleadosSeq" trace="disable" xmlns="http://ws.apache.org/ns/synapse">
    <log level="custom" category="DEBUG">
        <property name="*****CrearRegistroCargaMasivaSeq" value="Inicio..."/>
    </log>
    <payloadFactory media-type="json">
        <format>
			$1
		</format>
        <args>
            <arg evaluator="xml" expression="get-property('jsonEntrada')"/>
        </args>
    </payloadFactory>
    <script language="js"><![CDATA[var json = mc.getPayloadJSON();
		        var nA = JSON.stringify(json, null, "\r\t");
		        var nB = JSON.stringify(nA);
		        mc.setProperty('json',nB);]]></script>
    <payloadFactory media-type="json">
        <format>
			{
			"_postcreatemassiveprocess": {
			"guid": "$1",
			"json": "$2",
			"state": "N",
			"result": "P",
			"typeEvent":"$3",
			"typeAction": "$4",
			"observations": "",
			"username": "",
			"codigoTrabajador": "$5",
			"apellidosEmpleado": "$6",
			"nombresEmpleado": "$7",
			"identificacion": "$8",
			"identificacionSupervisor": "$9",
			"nombreSupervisor": "$10",
			"codigoCompania": "$11",
			"nombreCompania": "$12",
			"codigoAgrupacion": "$13",
			"nombreAgrupacion": "$14",
			"codigoDivision": "$15",
			"nombreDivision": "$16",
			"codigoDepartamento": "$17",
			"nombreDepartamento": "$18",
			"codigoArea": "$19",
			"nombreArea": "$20",
			"codigoSucursal": "$21",
			"nombreSucursal": "22",
			"codigoCentroCosto": "$23",
			"nombreCentroCosto": "$24",
			"nombreLocalidad": "$25",
			"nombreCargo": "$26",
			"codigoNivelJerarquico": "$27",
			"nombreNivelJerarquico":
			"$28",
			"numeroCuentaDeposito": "$29",
			"fechaIngresoEmpleado": "$30",
			"fechaSalidaEmpleado": "$31",
			"estadoEmpleado": "$32",
			"codigoEmpleado": "$33",
			"tipoUsuario":"$34",
			"subTipo": "$35",
			"modificaDatos":0,
			"recalculoPerfil":0,
			"fechaDatos":"$36"
			}
			}
		</format>
        <args>
            <arg evaluator="json" expression="$.ProcesarEmpleadoRequest.headerIn.guid"/>
            <arg evaluator="xml" expression="get-property('json')"/>
            <arg evaluator="xml" expression="get-property('typeEvent')"/>
            <arg evaluator="xml" expression="get-property('typeAction')"/>
            <arg evaluator="json" expression="$.ProcesarEmpleadoRequest.bodyIn.empleados.codigoTrabajador"/>
            <arg evaluator="json" expression="$.ProcesarEmpleadoRequest.bodyIn.empleados.apellidosEmpleado"/>
            <arg evaluator="json" expression="$.ProcesarEmpleadoRequest.bodyIn.empleados.nombresEmpleado"/>
            <arg evaluator="json" expression="$.ProcesarEmpleadoRequest.bodyIn.empleados.identificacion"/>
            <arg evaluator="json" expression="$.ProcesarEmpleadoRequest.bodyIn.empleados.identificacionSupervisor"/>
            <arg evaluator="json" expression="$.ProcesarEmpleadoRequest.bodyIn.empleados.nombreSupervisor"/>
            <arg evaluator="json" expression="$.ProcesarEmpleadoRequest.bodyIn.empleados.codigoCompania"/>
            <arg evaluator="json" expression="$.ProcesarEmpleadoRequest.bodyIn.empleados.nombreCompania"/>
            <arg evaluator="json" expression="$.ProcesarEmpleadoRequest.bodyIn.empleados.codigoAgrupacion"/>
            <arg evaluator="json" expression="$.ProcesarEmpleadoRequest.bodyIn.empleados.nombreAgrupacion"/>
            <arg evaluator="json" expression="$.ProcesarEmpleadoRequest.bodyIn.empleados.codigoDivision"/>
            <arg evaluator="json" expression="$.ProcesarEmpleadoRequest.bodyIn.empleados.nombreDivision"/>
            <arg evaluator="json" expression="$.ProcesarEmpleadoRequest.bodyIn.empleados.codigoDepartamento"/>
            <arg evaluator="json" expression="$.ProcesarEmpleadoRequest.bodyIn.empleados.nombreDepartamento"/>
            <arg evaluator="json" expression="$.ProcesarEmpleadoRequest.bodyIn.empleados.codigoArea"/>
            <arg evaluator="json" expression="$.ProcesarEmpleadoRequest.bodyIn.empleados.nombreArea"/>
            <arg evaluator="json" expression="$.ProcesarEmpleadoRequest.bodyIn.empleados.codigoSucursal"/>
            <arg evaluator="json" expression="$.ProcesarEmpleadoRequest.bodyIn.empleados.nombreSucursal"/>
            <arg evaluator="json" expression="$.ProcesarEmpleadoRequest.bodyIn.empleados.codigoCentroCosto"/>
            <arg evaluator="json" expression="$.ProcesarEmpleadoRequest.bodyIn.empleados.nombreCentroCosto"/>
            <arg evaluator="json" expression="$.ProcesarEmpleadoRequest.bodyIn.empleados.nombreLocalidad"/>
            <arg evaluator="json" expression="$.ProcesarEmpleadoRequest.bodyIn.empleados.nombreCargo"/>
            <arg evaluator="json" expression="$.ProcesarEmpleadoRequest.bodyIn.empleados.codigoNivelJerarquico"/>
            <arg evaluator="json" expression="$.ProcesarEmpleadoRequest.bodyIn.empleados.nombreNivelJerarquico"/>
            <arg evaluator="json" expression="$.ProcesarEmpleadoRequest.bodyIn.empleados.numeroCuentaDeposito"/>
            <arg evaluator="json" expression="$.ProcesarEmpleadoRequest.bodyIn.empleados.fechaIngresoEmpleado"/>
            <arg evaluator="json" expression="$.ProcesarEmpleadoRequest.bodyIn.empleados.fechaSalidaEmpleado"/>
            <arg evaluator="json" expression="$.ProcesarEmpleadoRequest.bodyIn.empleados.estadoEmpleado"/>
            <arg evaluator="json" expression="$.ProcesarEmpleadoRequest.bodyIn.empleados.codigoEmpleado"/>
            <arg evaluator="json" expression="$.ProcesarEmpleadoRequest.bodyIn.empleados.tipoUsuario"/>
            <arg evaluator="json" expression="$.ProcesarEmpleadoRequest.bodyIn.empleados.subTipo"/>
            <arg evaluator="json" expression="$.ProcesarEmpleadoRequest.headerIn.fechaHora"/>
        </args>
    </payloadFactory>
    <property action="remove" name="REST_URL_POSTFIX" scope="axis2"/>
    <property expression="get-property('apiAuthorizationToken')" name="Authorization" scope="transport" type="STRING"/>
    <call>
        <endpoint key="MassiveProcessDSS.createMassiveProcess"/>
    </call>
    <property expression="json-eval($.GeneratedKeys.Entry.id)" name="massiveProcessId" scope="default" type="STRING"/>
    <log level="custom" category="DEBUG">
        <property name="*****CrearRegistroCargaMasivaSeq" value="Fin..."/>
    </log>
</sequence>

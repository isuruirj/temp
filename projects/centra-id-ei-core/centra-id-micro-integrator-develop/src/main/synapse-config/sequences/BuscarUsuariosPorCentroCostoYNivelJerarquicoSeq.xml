<?xml version="1.0" encoding="UTF-8"?>
<sequence name="BuscarUsuariosPorCentroCostoYNivelJerarquicoSeq" onError="FaultSeq" trace="disable" xmlns="http://ws.apache.org/ns/synapse">
    <log level="custom" category="DEBUG">
        <property name="*****BuscarUsuariosPorCentroCostoYNivelJerarquicoSeq" value="Inicio.." />
    </log>
    <!-- Cargar variables de entorno -->
    <sequence key="MassiveProcessUsersVariablesLoadSeq" />
    <!-- Recuperar parametro global MAXIMA JERARQUIA PROPIETARIO DE PERFIL (MAJEPRPE) -->
    <property action="remove" name="REST_URL_POSTFIX" scope="axis2" />
    <call>
        <endpoint name="EntityGlobalParameter_Endpoint" template="HTTPEndpointGetTemplate" uri="{uri.var.enterpriseIntegratorHost}/api.centraid/common/GlobalParameter?code=MAJEPRPE" />
    </call>
    <property expression="//globalParameter/valueNumber" name="uri.var.hierarchyCode" scope="default" type="STRING" />
    <!-- Recuperar Usuarios por centro de costo y jerarquia -->
    <property action="remove" name="Content-Type" scope="transport" />
    <property action="remove" name="REST_URL_POSTFIX" scope="axis2" />
    <call>
        <endpoint name="UserDSS_Endpoint" template="HTTPEndpointGetTemplate" uri="{uri.var.dataServiceHost}/UsersDSS.HTTPEndpoint/getUserByNameAndCostCenterAndHierarchy?name={uri.var.name}&amp;costCenterCode={uri.var.costCenterCode}&amp;hierarchyCode={uri.var.hierarchyCode}" />
    </call>
    <property name="messageType" scope="axis2" type="STRING" value="application/json" />
    <property name="Access-Control-Allow-Origin" scope="transport" type="STRING" value="*" />
    <property name="Access-Control-Allow-Headers" scope="transport" type="STRING" value="Origin, X-Requested-With, Content-Type, Accept" />
    <log level="custom" category="DEBUG">
        <property name="*****BuscarUsuariosPorCentroCostoYNivelJerarquicoSeq" value="Fin.." />
    </log>
    <respond />
</sequence>
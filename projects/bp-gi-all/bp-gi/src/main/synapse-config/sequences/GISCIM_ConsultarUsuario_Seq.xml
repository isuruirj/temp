<?xml version="1.0" encoding="UTF-8"?>
<sequence name="GISCIM_ConsultarUsuario_Seq" trace="disable" xmlns="http://ws.apache.org/ns/synapse">
    <log description="seq" level="custom">
        <property name="seq" value="-------------------- GISCIM_ConsultarUsuario_Seq --------------------"/>
    </log>
    <filter regex=".*bancs.*" source="get-property('aplicacion')">
        <then>
            <property description="Override #username for BANCS" expression="$body/*/tem:tellerNumber/text()" name="username" scope="default" type="STRING" xmlns:tem="http://tempuri.org/"/>
        </then>
        <else/>
    </filter>
    <property description="HTTP_METHOD:GET" name="HTTP_METHOD" scope="axis2" type="STRING" value="GET"/>
    <property description="uri.var.resourcepath" expression="fn:concat('?filter=userName+eq+',get-property('aplicacion'),'/',get-property('username'))" name="uri.var.resourcepath" scope="default" type="STRING"/>
    <sequence key="GISCIM_Seq"/>
    <property description="userid" expression="json-eval($.Resources[0].id)" name="userid" scope="default" type="STRING"/>
    <payloadFactory description="Response" media-type="xml">
        <format>
            <consultarUsuarioResponse>$1</consultarUsuarioResponse>
        </format>
        <args>
            <arg evaluator="xml" expression="//*[local-name()='Body']//*[local-name()='EnterpriseUser']"/>
        </args>
    </payloadFactory>
</sequence>
